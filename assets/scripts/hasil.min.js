let selectK = $("#nilaiK"),
	nilaiK = selectK.length > 0 && selectK.children("option:selected").val(),
	chartLabels = [],
	chartData = [];
function chartHandler(a) {
	let t = parseInt(nilaiK),
		e = [];
	for (let i = 0; i < t; i++)
		(e[i] = `K${i + 1}`), (chartData[i] = a.hasil_sortir[i].jarak);
	let i = {
			labels: e,
			datasets: [
				{
					label: "Jarak Data",
					backgroundColor: "rgba(60,141,188,0.9)",
					borderColor: "rgba(60,141,188,0.8)",
					pointRadius: !1,
					pointColor: "#3b8bba",
					pointStrokeColor: "rgba(60,141,188,1)",
					pointHighlightFill: "#fff",
					pointHighlightStroke: "rgba(60,141,188,1)",
					data: chartData,
				},
			],
		},
		l = $("#lineChart").get(0).getContext("2d"),
		n = jQuery.extend(
			!0,
			{},
			{
				maintainAspectRatio: !1,
				responsive: !0,
				legend: { display: !0 },
				scales: {
					xAxes: [{ gridLines: { display: !0 } }],
					yAxes: [{ gridLines: { display: !0 } }],
				},
			}
		),
		r = jQuery.extend(!0, {}, i);
	(r.datasets[0].fill = !1), (n.datasetFill = !1);
	new Chart(l, { type: "line", data: r, options: n });
}
function randomRgb() {
	var a = Math.round,
		t = Math.random;
	return a(255 * t()) + "," + a(255 * t()) + "," + a(255 * t()) + ",";
}
async function getData(a) {
	let t;
	try {
		return (t = await $.ajax({
			url: `${BASE_URL}hasil/getSortir`,
			type: "GET",
			data: { k: a },
			dataType: "json",
		}));
	} catch (a) {}
}
async function dataHandler() {
	if (nilaiK > 10 || !parseInt(nilaiK)) return;
	const a = await getData(nilaiK);
	a && (tableHandler(a, nilaiK), chartHandler(a, nilaiK));
}
function tableHandler(a, t) {
	$("#sortirTable tbody").empty(),
		$.each(a.hasil_sortir, (e, i) => {
			$("#sortirTable tbody").append(
				`<tr class="text-center${
					i.kategori == a.kesimpulan && e < t ? " bg-light" : ""
				}">`
			),
				$.each(i.sampel, (l, n) => {
					$("#sortirTable tbody").append(
						`\n                <td class="align-middle text-center${
							i.kategori == a.kesimpulan && e < t ? " bg-light" : ""
						}">${n.nilai}</td>\n            `
					);
				}),
				$("#sortirTable tbody").append(
					`\n            <td class="align-middle text-center${
						i.kategori == a.kesimpulan && e < t ? " bg-light" : ""
					}">${i.jarak}</td>\n            <td class="align-middle text-center${
						i.kategori == a.kesimpulan && e < t ? " bg-light" : ""
					}">${i.kategori}</td>\n        `
				),
				$("#sortirTable tbody").append("</tr>");
		}),
		$("#kesimpulan b").text(a.kesimpulan);
}
nilaiK && dataHandler(),
	$("#nilaiK").change(function () {
		(nilaiK = $(this).children("option:selected").val()), dataHandler();
	});
